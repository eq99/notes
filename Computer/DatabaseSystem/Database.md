# 数据库原理与技术



# 数据库概述

## 数据模型与信息模型

现实世界：事物，特征，关键特征

信息模型：实体，属性，实体键

数据模型：记录，数据项，关键字

## 信息模型的表示



实体集之间的联系分为两种，即实体集之间的联系与实体集内部的联系。

实体集之间的联系是指不同实体集之间的联系。如学生集与老师集。

实体内部的联系是指实体集属性之间的相互关系。

:question: 学生集与学生集之间的关系算什么呢？

实体集间的联系主要分为如下三类：

- 一对一联系 1：1
- 一对多联系 1：n
- 多对多联系 m：n

## E-R图

实体集用矩形表示。

属性用椭圆表示。

联系用菱形表示。

## 数据模型三要素

- 数据结构：数据对象类型的集合，如关系模型中的域，属性，关系，各种键。
- 数据操作：增删改查
- 数据完整性约束

数据模型的分类：

- 三种基本的数据模型：层次模型，网状模型，关系模型
- 面型对象的模型：采用了面向对象方法中的对象，方法，消息，属性，继承等概念。
- 谓词模型：基于逻辑的模型，是演绎数据库与知识数据库的基础。
- XML模型
- NoSQL模型，数据结构简单多样
- 扩充的数据模型：综合体

## 三种基本模型的特点

**层次模型**

- 数据结构简单，查询效率高

- 良好的完整性支持

- 不适合表达多对多关系

- 数据库操作限制多，独立性差

**网状模型**

网状模型与层次模型的区别是网状模型的一个子结点可以有多个父结点。

- 较直接的描述现实世界
- 存储效率高
- 结构复杂，不易使用
- 数据独立性差

**关系模型**

实体之间的联系是通过表格自然表示的。

- 有坚实的理论基础
- 结构简单易用
- 数据独立性及安全性好
- 查询效率低



## 数据库系统结构

三级模式结构：子模式，模式和内模式

**模式（Schema）**

是数据库中全体数据的逻辑结构和特征描述，是所有用户的公用数据库结构。

- 一个数据库只有一个模式
- 模式与具体应用程序无关，他只是装配数据的一个框架
- 模式用语言描述和定义，需定义数据的逻辑结构、数据有关的安全性。

**子模式**

使用户所见和使用的局部数据的逻辑结构。

- 一个数据库可以有多个子模式，每个用户至少使用一个子模式。
- 同一个用户可以使用不同的子模式，每个子模式可以被不同的用户使用。
- 模式是对全体用户数据及其关系的的综合与抽象，子模式是根据所需对模式的抽取。

**内模式**

内模式是数据物理结构和存储方法的描述。

- 一个数据库只有一个内模式
- 一个数据库有多种文件构成，如用户数据文件，索引文件以及系统文件
- 内模式设计直接影响数据库的性能

**数据独立性与二级映像功能**

数据独立性是指数据与程序间的的互不依赖性。分为物理独立性与逻辑独立性。

物理独立性：数据库物理结构的改变不影响逻辑结构及应用程序。

逻辑独立性：数据库逻辑结构的变化不改变应用程序。

:bulb:模式与数据库的区别。模式是数据库结构的定义和描述，只是一个数据库的一个框架，他本身不涉及任何具体数据。数据库是按照模式的框架装入数据而建成的，他是模式的一个实例。

 **数据库系统结构**：单机模式，主从模式，CS模式，分布式



# 关系数据库

## 关系数据结构

**笛卡尔积**

笛卡尔积是在域上的运算。域是一组具有相同数据类型的集合。给定一组域 $D_1,D_2,\dots,D_n$ 的笛卡尔积为：
$$
D_1 \times D_2 \times \dots\times D_n=\{(d_1, d_2,\dots,d_n) \quad| \quad d_i \in D_i,\;i=1,2,\dots,n\}
$$
其中每个元素 $(d_1, d_2,\dots,d_n)$ 称为元组。

**关系**

一组域笛卡尔积的有限子集称为关系。

关系的基本数据关系是二维表。

元组与属性：二维表中的行称为关系的元组，列称为属性。列中的元素为该元素的该属性的的值，称为分量。每个属性所对应的值的变化范围叫属性的域，他是一个值的集合。

候选键：可唯一标识每一个元组的属性。

主键：用关系组织数据时，用一个候选键作为该关系的唯一性标识。

外键：关系 $R_1$ 中的一个属性不是它的候选键而是另一个关系 $R_2$ 的候选键。:bulb:外键提供了一种表示两个关系联系的方法。

组合键：把两个以上的属性作为唯一性标识。

**关系的性质**

- 每一列的数据类型相同
- 列名不允许相同
- 元组相异性
- 行序无关，列序无关
- 列中元素的值不可再分



**关系模式**（Relational Schema）

关系模式指出关系由哪些属性组成。

$R(U)=R(A_1,A_2,\dots,A_n)$



**关系的完整性约束**



- 实体完整性：主键的值不能为空。
- 参照完整性：外键要么空缺，要么引用一个实际存在的值。

- 用户定义的完整性：属性能否为空，是否唯一，取值范围，默认值，属性间满足函数关系？



# 关系代数

关系代数可分为：

- 集合运算
- 关系运算
- 扩冲的关系运算

## 集合运算

**并**

关系 $R$ 与 $S$ 的并由属于 $R$ 或属于 $S$ 的元组组成。记做：
$$
R \cup S=\{t | t\in R \or t \in S\}
$$
**差**

关系 $R$ 与 $S$ 的差由属于 $R$ 但不属于 $S$ 的元组组成。记做：
$$
R - S=\{t | t\in R \or t \notin S\}
$$
**交**

关系 $R$ 与 $S$ 的交由既属于 $R$ 又属于 $S$ 的元组组成。记做：
$$
R \cap S=\{t | t\in R \and t \in S\}
$$

**笛卡尔积**

关系 $R$ 与 $S$ 的笛卡尔积由 $R$ 中的元组与 $S$ 中的元组拼接而成。记做：
$$
R\times S=\{t_rt_s|(t_r\in R)\and(t_s\in S) \}
$$
<img src="/home/xiayulu/Desktop/notes/Computer/DatabaseSystem/set_op.jpg" alt="set_op" style="zoom:25%;" />



## 关系运算

**选择**（Selection）

选择关系上满足条件的元组，表示如下：
$$
\sigma_F(R)=\{t| F(t)=True\}
$$
**投影**（Projection）

投影就是选择关系中的某些属性， 由于元组不能重复，需要去重后输出：
$$
\Pi_A(R)=\{t[A]\}
$$
**连接**（Join）

连接就是在两个关系的笛卡尔积中选取满足一定条件的元组。记做：
$$
R \underset{A \theta B}{\bowtie} S= \sigma_{R.A\;\theta\;S.B}(R\times S)
$$

有两个特殊的连接：

1. 等值连接：即 $\theta$ 为 $=$
2. 自然连接：要求比较的分量必须是相同的属性组，记为

$$
R \bowtie S= \Pi_{去重后的属性组}\big(\sigma_{R.A_1=S.A_1\and\dots\and R.A_k= S.A_k}(R\times S)\big)
$$



**除**（Division）

设有关系 $R(X,Y)$ 和 $S(Y,Z)$，$\Pi_X(R)$ 属性上的值记为 $x_i$。

先介绍一个概念：像集

$x_i$在关系 $R$ 中对应的像集 $Y_X$ 定义为:
$$
Y_X= \Pi_Y(\sigma_{X=x_i}(R))
$$
那么 $R \div S$ 定义为$\{x_i\}$，$x_i$ 对应的像集 $Y_X$ 包含 $\Pi_Y(S)$ 

**[例子](https://www.cnblogs.com/yuanqi/p/4589967.html)**

<img src="./RdivS.png" alt="RdivS" style="zoom: 33%;" />

求得 $RS\div S$ 结果为：{ 张三 } 

$RS÷S$ 在这里解决的问题就是：得到选修了所有课程的学生。
$RS÷S$ 的意义就是：在RS中找出所有包含关系的S元组，然后投影。







# SQL语言



# 关系数据库理论



# 数据库设计



# 数据库保护与事务管理



# 对象关系数据库



